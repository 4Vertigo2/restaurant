CREATE DATABASE RESTAURANT_DB;

CREATE TABLE RESTAURANT_TBL(
	RESTAURANT_ID int AUTO_INCREMENT,
	RESTAURANT_NAME varchar(50) NOT NULL,
	UNIQUE(RESTAURANT_NAME),
	PRIMARY KEY(RESTAURANT_ID)
);

CREATE TABLE LOGIN_TBL(
	LOGIN_ID int AUTO_INCREMENT,
	LOGIN_USERNAME varchar(50) NOT NULL,
	LOGIN_PASSWORD varchar(50) NOT NULL,
	CHECK (7 < CHAR_LENGTH(LOGIN_PASSWORD)),
	UNIQUE(LOGIN_USERNAME),
	PRIMARY KEY(LOGIN_ID)
);

CREATE CUSTOMER_TBL(
	CUSTOMER_ID int AUTO_INCREMENT,
	CUSTOMER_FIRST_NAME varchar(50) NOT NULL,
	CUSTOMER_SURNAME varchar(50) NOT NULL,
	CUSTOMER_PHONE_NUMBER varchar(9) NOT NULL,
	CHECK (CUSTOMER_PHONE_NUMBER = 9),
	UNIQUE(CUSTOMER_PHONE_NUMBER),
	FOREIGN KEY(LOGIN_ID) REFERENCES LOGIN_TBL(LOGIN_ID) NOT NULL,
	PRIMARY KEY(CUSTOMER_ID)
);

CREATE STAFF_TBL(
	STAFF_ID int AUTO_INCREMENT,
	STAFF_FIRST_NAME varchar(50) NOT NULL,
	STAFF_SURNAME varchar(50) NOT NULL,
	FOREIGN KEY(RESTAURANT_ID) REFERENCES RESTAURANT_TBL(RESTAURANT_ID) NOT NULL,
	FOREIGN KEY(LOGIN_ID) REFERENCES LOGIN_TBL(LOGIN_ID) NOT NULL,
	PRIMARY KEY(STAFF_ID)
);

CREATE ORDER_TBL(
	ORDER_ID int AUTO_INCREMENT,
	ORDER_TIME DATETIME NOT NULL DEFAULT GETDATE(),
	ORDER_STATUS int NOT NULL DEFAULT -1,
	ORDER_RATING int NOT NULL DEFAULT 0,
	CHECK(ORDER_STATUS<2 AND ORDER_STATUS > -2),
	CHECK(ORDER_RATING<2 AND ORDER_RATING > -2),
	FOREIGN KEY(STAFF_ID) REFERENCES STAFF_TBL(STAFF_ID) NOT NULL,
	FOREIGN KEY(CUSTOMER_ID) REFERENCES CUSTOMER_TBL(CUSTOMER_ID) NOT NULL,
	PRIMARY KEY(ORDER_ID)
);

